#!/usr/bin/env python3
import subprocess
import time

def run_comprehensive_simulation():
    print("=== Comprehensive Post-Exploitation Simulation ===")

    capture_process = subprocess.Popen([
        'sudo', 'tcpdump', '-i', 'lo', '-w', 'comprehensive_attack.pcap'
    ])

    time.sleep(2)

    print("[+] Phase 1: Lateral Movement")
    subprocess.run(['python3', 'simulate_lateral_movement.py'])

    time.sleep(5)

    print("[+] Phase 2: C2 Communication")
    subprocess.run(['python3', 'simulate_c2_traffic.py'])

    time.sleep(10)

    capture_process.terminate()
    capture_process.wait()

    print("[+] Comprehensive simulation complete")
    print("[+] Analyze 'comprehensive_attack.pcap' with Wireshark")

if __name__ == "__main__":
    run_comprehensive_simulation()
