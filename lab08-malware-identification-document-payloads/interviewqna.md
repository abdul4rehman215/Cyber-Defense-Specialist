# ðŸ“˜ Interview Q&A â€“ Lab 08  
## Malware Identification in Document Payloads

---

### Q1. What was the primary objective of this lab?

**Answer:**  
The main objective of this lab was to identify malicious payloads embedded inside document files using both static and dynamic analysis techniques. The lab focused on detecting suspicious macros, keywords, obfuscation patterns, and runtime behaviors while ensuring safe analysis using sandboxing.

---

### Q2. Why is MIME type detection important in document malware analysis?

**Answer:**  
MIME type detection ensures that files are analyzed correctly based on their actual content rather than their file extension. Attackers often rename malicious files to bypass detection mechanisms. Using `python-magic`, the scanner verifies the true file type before performing analysis.

---

### Q3. Why were MD5 and SHA256 hashes calculated during analysis?

**Answer:**  
File hashing provides unique identifiers for files.  
- **MD5** is useful for quick comparisons.  
- **SHA256** provides stronger cryptographic integrity verification.  

Hashes allow analysts to:
- Identify duplicate malware samples  
- Check files against threat intelligence databases  
- Maintain integrity during investigations  

---

### Q4. How does oletools assist in detecting malicious Office documents?

**Answer:**  
Oletools extracts and analyzes VBA macros embedded inside Microsoft Office documents. Many malware campaigns use malicious macros to execute commands, download payloads, or establish persistence. Detecting macros is critical for identifying macro-based malware threats.

---

### Q5. How was the risk score calculated in this lab?

**Answer:**  
The risk score was calculated based on detected suspicious elements:
- Suspicious keywords added incremental risk points.
- Macro indicators increased risk weight.
- PDF JavaScript patterns increased scoring.
- Pattern-based detections contributed additional scoring.

Based on total score:
- 0â€“24 â†’ LOW  
- 25â€“49 â†’ MEDIUM  
- 50+ â†’ HIGH  

This risk-based classification helps prioritize incident response.

---

### Q6. What is the purpose of the batch_scanner.py module?

**Answer:**  
The batch scanner automates analysis across multiple documents within a directory. It:
- Recursively searches for supported document formats
- Scans each file using DocumentScanner
- Aggregates risk statistics
- Generates a structured summary JSON report

This improves efficiency in enterprise environments where multiple files must be analyzed.

---

### Q7. Why was Firejail used in this lab?

**Answer:**  
Firejail provides application sandboxing by restricting system access. It:
- Disables network connectivity
- Drops system capabilities
- Enforces read-only system libraries
- Prevents privilege escalation

This ensures suspicious documents are analyzed in isolation without risking host compromise.

---

### Q8. What does the dynamic_monitor.py script detect?

**Answer:**  
The dynamic monitor tracks runtime behavior during document execution by:
- Capturing baseline system processes
- Detecting newly spawned processes
- Monitoring active network connections

This helps detect malicious behaviors such as:
- Command execution
- Reverse shells
- Network callbacks
- Payload downloads

---

### Q9. What types of malicious patterns were detected using pattern_analyzer.py?

**Answer:**  
The pattern analyzer detected:

**Obfuscation Patterns**
- Chr(number) encoding
- String reversing
- Replace-based string manipulation

**Execution Patterns**
- Shell() calls
- WScript.Shell creation
- .Run() method invocation

**Download Patterns**
- URLDownloadToFile
- XMLHTTP requests
- WinHttp requests

These patterns are commonly found in macro-based malware.

---

### Q10. Why is combining static and dynamic analysis essential in malware detection?

**Answer:**  
Static analysis detects embedded threats such as suspicious keywords, macros, and obfuscation patterns. However, some malware only reveals malicious behavior at runtime.

Dynamic analysis helps identify:
- Process spawning
- Network activity
- Execution chains

Combining both methods improves detection accuracy and reduces false negatives.

---

### Q11. What security principle was reinforced during this lab?

**Answer:**  
The principle of **least privilege and isolation**. Suspicious files must never be opened directly on production systems. Sandboxing and automated analysis tools should always be used when handling unknown documents.

---

### Q12. How does structured JSON reporting benefit incident response teams?

**Answer:**  
JSON reports provide:
- Machine-readable output
- Easy integration with SIEM systems
- Standardized forensic documentation
- Automated ingestion into dashboards
- Faster triage and escalation workflows

Structured reporting ensures professional and repeatable analysis processes.

