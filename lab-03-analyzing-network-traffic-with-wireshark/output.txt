============================================================
Lab 03: Analyzing Network Traffic with Wireshark
Environment: Ubuntu Linux
User: toor
Host: ip-172-31-10-212
============================================================

========================
SYSTEM PREPARATION
========================

$ sudo apt update
Hit:1 http://archive.ubuntu.com/ubuntu noble InRelease
Hit:2 http://security.ubuntu.com/ubuntu noble-security InRelease
Reading package lists... Done

$ sudo apt install -y wireshark tshark curl wget dnsutils
Setting up wireshark-common ...
Setting up tshark ...
Setting up wireshark ...
Wireshark installed successfully.

$ sudo usermod -a -G wireshark toor
User added to wireshark group.

$ newgrp wireshark

$ getcap /usr/bin/dumpcap
/usr/bin/dumpcap = cap_net_admin,cap_net_raw+eip

========================
INTERFACE VERIFICATION
========================

$ ip link show
2: ens5: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 9001 state UP

$ tshark -D
1. ens5
2. lo

Primary capture interface identified: ens5

========================
DNS TRAFFIC GENERATION
========================

$ nslookup google.com
Name: google.com
Address: 142.250.182.46

$ nslookup facebook.com
Name: facebook.com
Address: 157.240.229.35

$ nslookup malicious-domain-example.com
** server can't find malicious-domain-example.com: NXDOMAIN

========================
HTTP TRAFFIC GENERATION
========================

$ curl -v http://httpbin.org/get
> GET /get HTTP/1.1
< HTTP/1.1 200 OK

$ curl -H "User-Agent: SuspiciousBot/1.0" http://httpbin.org/user-agent
{
  "user-agent": "SuspiciousBot/1.0"
}

========================
HTTPS / TLS TRAFFIC
========================

$ curl -v https://www.google.com
* TLSv1.3 handshake complete
< HTTP/2 200

$ curl -k https://self-signed.badssl.com/
* SSL certificate problem: self signed certificate

========================
DNS ANALYSIS SCRIPT OUTPUT
========================

$ ./analyze_dns.sh

=== DNS Traffic Analysis ===

Top DNS Queries:
5 google.com
3 facebook.com
1 malicious-domain-example.com
1 suspicious.example.com

Potential Suspicious Domains:
malicious-domain-example.com
suspicious.example.com

Top-Level Domain Analysis:
7 .com
2 .org
1 .example

DNS Responses:
google.com        142.250.182.46
facebook.com      157.240.229.35

========================
DNS TUNNELING CHECK
========================

$ ./detect_dns_tunneling.sh

DNS Query Types:
10 A
2 AAAA

Average subdomains per query: 1.4

No DNS tunneling detected.

========================
HTTP ANALYSIS OUTPUT
========================

$ ./analyze_http.sh

HTTP Methods Used:
5 GET
1 POST

User Agents:
3 curl/8.5.0
1 Mozilla/5.0
1 SuspiciousBot/1.0

Requested URLs:
/get
/post
/cookies/set/session/abc123

HTTP Response Codes:
6 200

Suspicious User-Agents:
SuspiciousBot/1.0

========================
HTTP ANOMALY DETECTION
========================

$ ./detect_http_anomalies.sh

SQL Injection patterns:
None detected

XSS patterns:
None detected

Directory traversal attempts:
None detected

========================
TLS ANALYSIS OUTPUT
========================

$ ./analyze_tls.sh

TLS Versions Used:
6 TLS 1.3
2 TLS 1.2

Server Name Indication:
www.google.com
httpbin.org
badssl.com
self-signed.badssl.com

Cipher Suites:
TLS_AES_128_GCM_SHA256
TLS_AES_256_GCM_SHA384

Certificate Issuers:
Google Trust Services LLC
badssl.com

========================
TLS SECURITY CHECK
========================

$ ./detect_tls_issues.sh

GOOD: TLS 1.3 detected
INFO: TLS 1.2 detected

Certificate validation alert detected:
Self-signed certificate observed

Perfect Forward Secrecy:
ECDHE supported

========================
COMPREHENSIVE REPORT
========================

$ ./comprehensive_analysis.sh

COMPREHENSIVE NETWORK TRAFFIC ANALYSIS REPORT
Generated on: Wed Jan 08 2026
Analyst: toor

Findings:
- Suspicious DNS domains detected
- Unusual HTTP User-Agent observed
- TLS encryption strong (TLS 1.2 / 1.3)
- One self-signed certificate detected

Recommendations:
- Monitor DNS queries for anomalies
- Block unknown User-Agents
- Enforce TLS 1.2+ with valid certificates

============================================================
END OF OUTPUT FILE
============================================================
