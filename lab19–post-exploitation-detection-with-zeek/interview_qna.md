# üìò Interview Q&A ‚Äì Lab 19  
## Post-Exploitation Detection with Zeek

---

### 1Ô∏è‚É£ Q: What is Zeek and why is it used in cybersecurity?

**Answer:**
Zeek is a network security monitoring (NSM) platform that analyzes network traffic and generates detailed, structured logs.  
It is used to detect:

- Command & Control (C2) communication
- Port scanning
- Data exfiltration
- Lateral movement
- Suspicious DNS activity
- Post-exploitation behaviors

Unlike traditional IDS tools, Zeek focuses on behavioral network analysis rather than only signature-based detection.

---

### 2Ô∏è‚É£ Q: How was Zeek configured in this lab?

**Answer:**
Zeek was configured in **standalone mode** by editing:

```
/opt/zeek/etc/node.cfg
```

Configuration:
```
[zeek]
type=standalone
host=localhost
interface=lo
```

Networks were defined in:

```
/opt/zeek/etc/networks.cfg
```

This allowed Zeek to monitor loopback (lo) traffic and properly classify internal network ranges.

---

### 3Ô∏è‚É£ Q: Which Zeek logs are most important for post-exploitation detection?

**Answer:**

| Log File      | Purpose |
|---------------|----------|
| `conn.log`    | Connection metadata (IPs, ports, bytes transferred) |
| `http.log`    | HTTP requests & User-Agent analysis |
| `dns.log`     | DNS query monitoring |
| `notice.log`  | Security alerts generated by custom scripts |

`notice.log` is the most important for detection validation.

---

### 4Ô∏è‚É£ Q: How can Zeek detect port scanning?

**Answer:**
By counting how many **unique destination ports** a source IP connects to.

If the number exceeds a defined threshold (e.g., 20 ports), Zeek generates:

```
Notice::Port_Scan
```

In this lab, scanning ports 20‚Äì40 triggered detection.

---

### 5Ô∏è‚É£ Q: What is C2 beaconing and how was it detected?

**Answer:**
C2 beaconing is repeated communication between an infected host and attacker infrastructure.

Detection method used:
- Track repeated connections between same source and destination IP
- Trigger alert when count exceeds threshold

Resulting alert:
```
Notice::Sensitive_Activity
Possible beaconing between 127.0.0.1 and 93.184.216.34
```

---

### 6Ô∏è‚É£ Q: How was data exfiltration detected?

**Answer:**
Two detection mechanisms:

1Ô∏è‚É£ Large upload detection  
If `orig_bytes > 10MB` ‚Üí alert generated

2Ô∏è‚É£ HTTP content inspection  
If HTTP body contains keywords:
```
password
token
secret
credential
key
```

This triggers:
```
Notice::Sensitive_Activity
```

---

### 7Ô∏è‚É£ Q: How did you simulate post-exploitation traffic?

**Answer:**
Using a custom traffic generator script that simulated:

- Suspicious User-Agent ("malware-bot")
- Large 12MB upload
- Port scan (20‚Äì40)
- Suspicious DNS query (malware-c2.com)
- Connection flood (60 connections)
- Beaconing behavior (6 repeated connections)

This created realistic attack patterns in PCAP.

---

### 8Ô∏è‚É£ Q: What indicators confirmed successful detection?

**Answer:**
The `notice.log` file contained alerts for:

‚úî High connection count  
‚úî Port scan detected  
‚úî Large upload detected  
‚úî Suspicious User-Agent  
‚úî Suspicious DNS query  
‚úî Beaconing activity  
‚úî High cumulative upload volume  

Total alerts generated: **7**

---

### 9Ô∏è‚É£ Q: How can Zeek help detect lateral movement?

**Answer:**
By monitoring connections to administrative ports:

- 22 (SSH)
- 3389 (RDP)
- 445 (SMB)
- 135 (RPC)

Repeated internal connections to these ports may indicate lateral movement within a network.

---

### üîü Q: Why is Zeek powerful for post-exploitation detection?

**Answer:**

Zeek provides:

- Deep protocol visibility
- Scriptable behavioral detection
- Structured log generation
- Detection of C2 and beaconing
- Data exfiltration identification
- Network-level forensics capability

It enables **behavioral threat detection beyond signature-based IDS tools**.

---

## ‚úÖ Final Takeaway

In this lab, you successfully:

- Installed and configured Zeek
- Built 3 custom detection scripts
- Simulated real-world post-exploitation behaviors
- Generated and validated NOTICE alerts
- Performed advanced network log analysis
- Created automated reporting

These are real-world **Network Security Monitoring (NSM)** and **SOC detection engineering** skills.
