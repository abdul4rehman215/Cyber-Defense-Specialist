# ğŸ§ª Lab 19 â€“ Post-Exploitation Detection with Zeek

---

## ğŸ“Œ Lab Summary

This lab focuses on detecting post-exploitation behaviors using Zeek Network Security Monitor.

You installed Zeek, configured it in standalone mode, wrote custom detection scripts, simulated attack traffic, analyzed generated logs, and built automated analysis and reporting scripts.

The lab demonstrates detection of:

- Command & Control (C2) communication
- Beaconing behavior
- Data exfiltration
- Port scanning
- Lateral movement
- Connection flooding
- Suspicious DNS and HTTP patterns

This simulates real-world Network Security Monitoring (NSM) and SOC detection engineering.

---

## ğŸ¯ Objectives

- Install and configure Zeek on Ubuntu 24.04
- Write custom Zeek scripts for post-exploitation detection
- Detect C2 communication patterns
- Detect port scanning behavior
- Detect data exfiltration attempts
- Identify beaconing behavior
- Analyze Zeek logs programmatically
- Generate automated security reports

---

## ğŸ“Œ Prerequisites

- Basic Linux command line proficiency
- Understanding of TCP/IP networking
- Familiarity with HTTP, DNS, SSH protocols
- Basic scripting knowledge (bash)
- No prior Zeek experience required

---

## ğŸ–¥ Lab Environment

- Host: ip-172-31-10-221  
- User: toor  
- OS: Ubuntu 24.04 LTS  
- RAM: 4GB  
- Interface monitored: lo (loopback)  
- Zeek Version: 6.0.0  

---

## ğŸ“ Project Structure (Repository Format)

```
lab19-zeek-post-exploitation/
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ unusual-connections.zeek
â”‚   â”œâ”€â”€ c2-detection.zeek
â”‚   â”œâ”€â”€ data-exfiltration.zeek
â”‚   â”œâ”€â”€ generate-traffic.sh
â”‚   â”œâ”€â”€ analyze-logs.sh
â”‚   â”œâ”€â”€ advanced-analysis.sh
â”‚   â””â”€â”€ create-report.sh
â”‚
â”œâ”€â”€ pcaps/
â”‚   â””â”€â”€ test-traffic.pcap
â”‚
â”œâ”€â”€ analysis/
â”‚   â”œâ”€â”€ conn.log
â”‚   â”œâ”€â”€ http.log
â”‚   â”œâ”€â”€ dns.log
â”‚   â”œâ”€â”€ notice.log
â”‚   â””â”€â”€ security-report.txt
â”‚
â”œâ”€â”€ commands.sh
â”œâ”€â”€ output.txt
â”œâ”€â”€ interview_qna.md
â””â”€â”€ troubleshooting.md
```

---

## â–¶ Execution Flow

1. Install Zeek and configure standalone node
2. Define monitored networks
3. Capture traffic using tcpdump
4. Generate simulated post-exploitation traffic
5. Process PCAP with Zeek
6. Execute custom detection scripts
7. Generate NOTICE alerts
8. Run automated log analysis scripts
9. Generate executive security report

---

## ğŸ” Detection Capabilities Implemented

### 1ï¸âƒ£ Unusual Connections Detection
- High connection count
- Port scan behavior
- High data transfer volumes

### 2ï¸âƒ£ C2 Detection
- Suspicious user-agents
- Suspicious DNS domains
- Beaconing behavior (repeated connections)

### 3ï¸âƒ£ Data Exfiltration Detection
- Large uploads (>10MB)
- Keyword-based sensitive data inspection
- Cumulative data volume tracking

---

## ğŸ“Š Expected Outcomes

- Zeek successfully processes PCAP files
- Custom scripts generate NOTICE alerts
- Port scan detected
- Suspicious DNS detected
- Large upload flagged
- Beaconing behavior detected
- Executive security report generated

---

# ğŸ Final Conclusion

This lab successfully demonstrated post-exploitation detection using Zeek Network Security Monitor.

You:

âœ” Installed and configured Zeek  
âœ” Built 3 custom detection scripts  
âœ” Simulated realistic attack behavior  
âœ” Captured and analyzed network traffic  
âœ” Detected port scans and connection floods  
âœ” Identified C2 beaconing patterns  
âœ” Detected suspicious DNS communication  
âœ” Flagged large data exfiltration attempts  
âœ” Generated structured NOTICE alerts  
âœ” Created automated log analysis scripts  
âœ” Built a security dashboard report  

This lab models real-world Network Security Monitoring and SOC detection engineering.

---

# ğŸ§  Key Learning Outcomes

- Post-exploitation leaves network traces
- Beaconing creates repetitive traffic patterns
- Data exfiltration produces abnormal volume spikes
- C2 communication often uses suspicious DNS + HTTP behavior
- Port scans generate distinct multi-port patterns
- Zeek scripting enables behavioral-based detection
- Automated log analysis improves SOC efficiency

---

# ğŸ“ˆ Key Metrics Verified

- Zeek version confirmed
- PCAP successfully captured
- 210 total connections processed
- 7 NOTICE alerts generated
- Suspicious behaviors successfully detected
- Executive security report created

---

# ğŸš¨ Why This Matters

Traditional firewalls focus on blocking traffic.

Zeek focuses on **behavioral detection**.

Post-exploitation detection is critical because:

- Attackers often bypass perimeter defenses
- C2 communication happens silently
- Data exfiltration may look like normal traffic
- Lateral movement uses legitimate protocols

Network-based behavioral detection provides visibility after compromise.

---

# ğŸŒ Real-World Applications

Skills developed in this lab apply directly to:

- SOC Analyst roles
- Network Security Monitoring (NSM)
- Threat Hunting
- Incident Response
- Detection Engineering
- Blue Team operations

---

# ğŸš€ Real-World Impact

This lab demonstrates practical detection engineering skills:

- Custom Zeek scripting
- Behavioral anomaly detection
- Traffic simulation testing
- Automated log analysis
- Executive-level reporting

These are enterprise-grade SOC and NSM capabilities.

---

## ğŸ† Result

Advanced post-exploitation detection framework successfully implemented using Zeek.
