#!/usr/bin/env python3

import re
import json

class AnomalyDetector:
    def extract_ip_addresses(self, text):
        return re.findall(r'\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b', text)

    def calculate_risk_level(self, anomalies):
        count = len(anomalies)
        if count >= 10:
            return "HIGH"
        elif count >= 5:
            return "MEDIUM"
        return "LOW"

    def generate_report(self, anomalies):
        risk = self.calculate_risk_level(anomalies)
        print("=== MALWARE DETECTION REPORT ===")
        print("Total anomalies:", len(anomalies))
        print("Risk level:", risk)

        with open("malware_report.json", "w") as f:
            json.dump({"anomalies": anomalies, "risk": risk}, f, indent=2)

def main():
    detector = AnomalyDetector()
    anomalies = []

    with open("/var/log/syslog", "r", errors="ignore") as f:
        for line in f:
            if "failed" in line.lower():
                anomalies.append(line.strip())

    detector.generate_report(anomalies)
    print("Analysis complete")

if __name__ == "__main__":
    main()
