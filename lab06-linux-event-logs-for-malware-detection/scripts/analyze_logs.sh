#!/bin/bash

RESULTS_DIR="$HOME/malware_lab/results"
mkdir -p "$RESULTS_DIR"

echo "[+] Extracting suspicious network activity..."
grep -Ei "tcp|udp|connection|network" /var/log/syslog > "$RESULTS_DIR/network_activity.txt"

echo "[+] Extracting failed authentication attempts..."
grep -Ei "failed password|invalid user|authentication failure" /var/log/auth.log > "$RESULTS_DIR/auth_failures.txt"

echo "[+] Extracting unusual process events..."
grep -Ei "killed|segmentation fault|core dumped" /var/log/syslog > "$RESULTS_DIR/process_anomalies.txt"

echo "[+] Summary:"
echo "Network events: $(wc -l < "$RESULTS_DIR/network_activity.txt")"
echo "Auth failures: $(wc -l < "$RESULTS_DIR/auth_failures.txt")"
echo "Process anomalies: $(wc -l < "$RESULTS_DIR/process_anomalies.txt")"

echo "Analysis complete. Check ~/malware_lab/results/"
